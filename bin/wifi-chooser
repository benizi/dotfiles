#!/bin/sh
net=${1:-"$(if hash nmcli 2>&- ; then
  nmcli -f SSID dev wifi list \
  | sed '1d;s/^.//;s/[[:space:]]*$//;s/.$//'
elif hash wicd-cli 2>&- ; then
  echo '<cli>'
  echo '<rescan>'
  wicd-cli --wireless -l | sed 1d | awk -F$'\t' '{ if (!seen[$NF]++) print $NF ":" $1}'
fi \
| sort \
| uniq \
| dmenu -l 40)"}
if test -n "$net" ; then
  case "$net" in
    '<cli>') term -e sudo su - -s $(which wicd-curses) ;;
    '<rescan>') wifi-rescan ;;
    *:*) wicd-cli -y -c -n ${net##*:} ;;
    *) wifi "$net" ;;
  esac
fi
