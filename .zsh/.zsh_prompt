setopt promptsubst
export PROMPT='%{${PSCOLOR}%(!.${PSCOLORALL-${PSCOLORROOT-$UNDERLINE}}.${PSCOLORALL-$PSCOLORNORM})%}%n@%m %~%(!.#.$)%{${NOCOLOR}%} '
export PS1
function fancytitle () {
	local c
	[ -n "$NO_UTF8_TITLE" ] && c='|' || c='│'
	print -nP '${TITLE}$1%(!.ROOT $c .)%m $c %~ $c %n${STY+ $c $$}${ENDTITLE}'
}
function preexec () {
	if [ $SHLVL -eq 1 -a "$TERM" = "linux" ] ; then return ; fi
	[[ -z "$NOTITLE" ]] || return
	COMMAND="$1 │ "
	COMMAND=$COMMAND:gs/%/%%/ #:gs/\$/\\\\\$/
	fancytitle $COMMAND
}
function precmd () {
	if [ $SHLVL -eq 1 -a "$TERM" = "linux" ] ; then return ; fi
	[[ -z "$NOTITLE" ]] || return
	fancytitle ""
}
